{% extends 'base.html' %}

{% block content %}
<style>
    .fixed-size-image {
        width: 100%;
        height: 200px;
        object-fit: cover;
    }
</style>

<!-- Header -->
<header class="bg-dark py-5">
    <div class="container px-4 px-lg-5 my-2">
        <div class="d-flex justify-content-center align-items-center text-white">
            <img src="/media/photos/site/cardealerLogo.png" alt="Logo" class="logo mr-3">
            <div class="text-center">
                <h1 class="display-4 fw-bolder"></h1>
            </div>
        </div>
    </div>
</header>
<br /><br />

<div>
    <section class="container-fluid mb-6">
        <div class="row px-5">
            <!-- Formulaire de filtrage (petite colonne à gauche) -->
            <div class="col-md-2 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h2>Filtrer</h2>
                    </div>
                    <div class="card-body">
                        <!-- Formulaire de filtrage -->
                        <form method="GET" class="mb-3" id="filter-form">
                            <div class="mb-3">
                                <label for="marque">Marque</label>
                                <select id="marque" name="marque" class="form-select">
                                    <option value="">Tous</option>
                                    {% for marque in marques_disponibles %}
                                        <option value="{{ marque }}" {% if request.GET.marque == marque %}selected{% endif %}>{{ marque }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="carburant">Carburant</label>
                                <select id="carburant" name="carburant" class="form-select">
                                    <option value="">Tous</option>
                                    {% for carburant in carburants_disponibles %}
                                        <option value="{{ carburant }}" {% if request.GET.carburant == carburant %}selected{% endif %}>{{ carburant }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="transmission">Transmission</label>
                                <select id="transmission" name="transmission" class="form-select">
                                    <option value="">Tous</option>
                                    {% for transmission in transmissions_disponibles %}
                                        <option value="{{ transmission }}" {% if request.GET.transmission == transmission %}selected{% endif %}>{{ transmission }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="d-flex justify-content-end">
                                <button type="submit" class="btn btn-primary">Filtrer</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Résultats des véhicules (plus grande colonne à droite) -->
            <div class="col-md-10 mb-4">
                <h2 class="mb-4 display-4 text-center">Nos véhicules d'occasions</h2>
                <div class="card">
                    <div class="card-body">
                        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 justify-content-center">
                            {% for voiture in voitures %}
                            <div class="col mb-4">
                                <div class="card h-100 position-relative">
                                    {% if voiture.images.all %}
                                    <img src="{{ voiture.images.first.image.url }}"
                                                    class="d-block w-100 fixed-size-image" alt="...">
                                    {% endif %}
                                    <!-- Détails du véhicule -->
                                    <div class="card-body p-3">
                                        <div class="text-center">
                                            <h6 class="card-title">{{ voiture.modele.nom }} - {{ voiture.annee_fabrication }}</h6>
                                            <p class="card-text">{{ voiture.marque.nom }}</p>
                                            <p class="text-muted">{{ voiture.prix }}.00€</p>
                                        </div>
                                    </div>
                                    <!-- Actions -->
                                    <div class="card-footer p-3 border-top-0 bg-light">
                                        <div class="text-center">
                                            <a class="btn btn-outline-dark mt-auto"
                                                href="{% url 'voiture' voiture.id %}">Details</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

{% endblock %}
